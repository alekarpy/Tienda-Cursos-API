<div class="wishlist-page">
  <div class="wishlist-header">
    <button class="back-btn" (click)="goBack()">
      <div style="display: flex">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-chevron-left-icon lucide-chevron-left mr-1"
        >
          <path d="m15 18-6-6 6-6" />
        </svg>
        Volver
      </div>
    </button>

    <h1>Mi Lista de Deseos</h1>
    <button
      class="clear-btn"
      (click)="clearWishlist()"
      *ngIf="products.length > 0"
    >
      <div style="display: flex">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-trash-icon lucide-trash mr-3"
        >
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
          <path d="M3 6h18" />
          <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
        </svg>
        Limpiar Lista
      </div>
    </button>
  </div>

  <div class="wishlist-content">
    <!-- Loading -->
    <div *ngIf="isLoading">
      <app-wishlist-skeleton [count]="3"></app-wishlist-skeleton>
    </div>

    <!-- Error -->
    <div *ngIf="error && !isLoading" class="error-state">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h2>Error</h2>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="loadWishlist()">Reintentar</button>
    </div>

    <!-- Wishlist vac√≠a -->
    <div
      *ngIf="!isLoading && !error && products.length === 0"
      class="empty-wishlist"
    >
      <div class="empty-icon">üíù</div>
      <h2>Tu lista de deseos est√° vac√≠a</h2>
      <p>¬°Explora nuestros cursos y guarda tus favoritos para m√°s tarde!</p>
      <button class="explore-btn" (click)="goToCourses()">
        Explorar Cursos
      </button>
    </div>

    <!-- Wishlist con productos -->
    <div
      *ngIf="!isLoading && !error && products.length > 0"
      class="wishlist-with-items"
    >
      <div class="wishlist-items-list">
        <div class="wishlist-item" *ngFor="let product of products">
          <div class="item-image">
            <img
              [src]="getProductImage(product)"
              [alt]="product.title"
              class="product-img"
            />
          </div>

          <div class="item-details">
            <h3 class="item-title">{{ product.title }}</h3>
            <p class="item-description">{{ product.description }}</p>
            <div class="item-meta">
              <span class="item-level">{{ product.level }}</span>
              <span class="item-rating">‚≠ê {{ product.rating || 0 }}</span>
              <span class="item-category">{{ getCategoryName(product) }}</span>
              <span class="item-students" *ngIf="product.students"
                >üë• {{ product.students }} estudiantes</span
              >
            </div>
          </div>

          <div class="item-controls">
            <div class="price-section">
              <div class="item-price">
                ${{ product.price | number : "1.2-2" }}
              </div>
            </div>

            <div class="action-buttons">
              <button (click)="addToCart(product)" class="add-to-cart-btn">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="mr-2"
                >
                  <path
                    d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"
                  />
                  <line x1="3" y1="6" x2="21" y2="6" />
                  <path d="M16 10a4 4 0 0 1-8 0" />
                </svg>
                Agregar al Carrito
              </button>
              <button
                (click)="removeFromWishlist(product._id!)"
                class="remove-btn"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="mr-2"
                >
                  <path d="M3 6h18" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
                  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                </svg>
                Eliminar
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="wishlist-summary">
        <div class="summary-card">
          <h3>Resumen</h3>
          <div class="summary-info">
            <div class="summary-row">
              <span>Total de productos:</span>
              <span
                ><strong>{{ products.length }}</strong></span
              >
            </div>
            <div class="summary-row">
              <span>Valor total:</span>
              <span class="total-value"
                >${{ getTotalValue() | number : "1.2-2" }}</span
              >
            </div>
          </div>

          <button class="continue-shopping" (click)="goToCourses()">
            ‚Üê Seguir Explorando
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

